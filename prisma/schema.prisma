generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model credentials {
  user_id  Int    @id
  password String
  users    users  @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_credentials_user")
}

model location {
  user_id         Int       @id
  latitude        Decimal   @db.Decimal(9, 7)
  longitude       Decimal   @db.Decimal(9, 7)
  connection_time DateTime? @db.Timestamp(6)
  users           users     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_location_user")
}

model users {
  user_id        Int             @id @default(autoincrement())
  username       String          @unique @db.VarChar(100)
  user_type      String          @db.VarChar(10)
  email          String          @unique @db.VarChar(50)
  phone          Json
  first_name     String?         @db.VarChar(20)
  last_name      String?         @db.VarChar(20)
  created_at     DateTime?       @default(now()) @db.Timestamp(6)
  cart           cart[]
  credentials    credentials?
  food_items     food_items[]
  location       location?
  profile_images profile_images?
}

model food_item_images {
  image_id   Int        @id @default(autoincrement())
  food_id    Int
  image_url  String
  created_at DateTime?  @default(now()) @db.Timestamp(6)
  food_items food_items @relation(fields: [food_id], references: [food_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_food_image")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model food_item_reviews {
  review_id  Int        @id @default(autoincrement())
  food_id    Int
  rating     Int
  review     String?
  created_at DateTime?  @default(now()) @db.Timestamp(6)
  food_items food_items @relation(fields: [food_id], references: [food_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_food")
}

model food_items {
  food_id           Int                 @id @default(autoincrement())
  user_id           Int
  name              String              @db.VarChar(100)
  description       String?
  price             Decimal             @db.Decimal(10, 2)
  discount_price    Decimal?            @db.Decimal(10, 2)
  category          String?             @db.VarChar(50)
  is_veg            Boolean?            @default(false)
  is_available      Boolean?            @default(true)
  calories          Int?
  created_at        DateTime?           @default(now()) @db.Timestamp(6)
  updated_at        DateTime?           @default(now()) @db.Timestamp(6)
  cart              cart[]
  food_item_images  food_item_images[]
  food_item_reviews food_item_reviews[]
  users             users               @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_food_items_user")
}

model profile_images {
  user_id    Int       @id
  original   String    @db.VarChar(255)
  thumbnail  String    @db.VarChar(255)
  created_at DateTime? @default(now()) @db.Timestamp(6)
  users      users     @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_profile_images_user")
}

model cart {
  user_id        Int
  food_id        Int
  quantity       Int        @default(1)
  name           String     @db.VarChar(100)
  discount_price Decimal?   @db.Decimal(10, 2)
  added_at       DateTime?  @default(now()) @db.Timestamp(6)
  image_url      Json?
  food_items     food_items @relation(fields: [food_id], references: [food_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cart_food")
  users          users      @relation(fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cart_user")

  @@id([user_id, food_id])
}

model user_full_profile {
  user_id                   Int      @id
  username                  String
  user_type                 String
  email                     String
  phone                     Json
  first_name                String?
  last_name                 String?
  created_at                DateTime?

  latitude                  Decimal? @db.Decimal(9, 7)
  longitude                 Decimal? @db.Decimal(9, 7)
  connection_time           DateTime?

  profile_image_original    String?
  profile_image_thumbnail   String?

  @@map("user_full_profile")
}

model food_items_view {
  food_id        Int      @id
  user_id        Int
  name           String
  description    String?
  price          Decimal
  discount_price Decimal?
  category       String?
  is_veg         Boolean
  is_available   Boolean
  calories       Int?
  created_at     DateTime
  updated_at     DateTime
  image_urls     Json

  @@map("food_items_view")
}